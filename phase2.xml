<!-- phase2.xml -->
<phase>
  <id>phase2</id>
  <name>Backend & Authentication Foundation</name>
  <goal>
    Introduce a Node.js backend with MariaDB and basic user authentication, preparing for protected planner routes.
  </goal>
  <basedOnPrdSections>
    <section>dataModel.entities.User</section>
    <section>apiDesign.auth</section>
    <section>architecture.backend</section>
  </basedOnPrdSections>
  <scope>
    <in>
      <item>Node.js server (Express or Fastify)</item>
      <item>MariaDB schema setup for User and basic Exhibition tables</item>
      <item>Register, login, and "current user" endpoints</item>
      <item>Protected frontend route /exhibition/:slug/edit requiring login</item>
    </in>
    <out>
      <item>No artwork upload or placement yet</item>
      <item>No versioning or constraints logic</item>
    </out>
  </scope>
  <requirements>
    <backend>
      <item>Set up Node.js project and connect to MariaDB using an ORM (e.g. Prisma/Sequelize).</item>
      <item>Create User table with fields: id, email, password_hash, role (curator/admin).</item>
      <item>Implement /auth/register, /auth/login, /auth/me endpoints with JWT or similar session mechanism.</item>
      <item>Create minimal Exhibition table (id, title, slug, room_id) for later use.</item>
    </backend>
    <frontend>
      <item>Add login and registration views.</item>
      <item>Implement auth state handling (e.g. via Zustand) and store the token.</item>
      <item>Protect /exhibition/:slug/edit route; redirect unauthenticated users to login with redirect back.</item>
    </frontend>
  </requirements>
  <successCriteria>
    <item>New users can register and log in.</item>
    <item>Authenticated users can open /exhibition/:slug/edit; unauthenticated users are redirected to /login.</item>
  </successCriteria>
</phase>
